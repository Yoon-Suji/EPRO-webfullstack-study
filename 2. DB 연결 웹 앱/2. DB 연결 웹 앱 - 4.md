# 2. DB ì—°ê²° ì›¹ ì•±

## 4. redirect & forward - BE

### 1) redirect

* HTTPí”„ë¡œí† ì½œë¡œ ì •í•´ì§„ ê·œì¹™, **ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ëŒ€í•´ íŠ¹ì • URLë¡œ ì´ë™ì„ ë‹¤ì‹œ ìš”ì²­**í•˜ëŠ” ê²ƒ.

* ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ **HTTP ìƒíƒœì½”ë“œ 302**ë¡œ ì‘ë‹µí•˜ëŠ”ë° ì´ë•Œ í—¤ë” ë‚´ Location ê°’ì— **ì´ë™í•  URL** ì„ ì¶”ê°€í•œë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ë¦¬ë‹¤ì´ë ‰ì…˜ ì‘ë‹µì„ ë°›ê²Œ ë˜ë©´ í—¤ë”(Location)ì— í¬í•¨ëœ URLë¡œ **ì¬ìš”ì²­**ì„ ë³´ë‚´ê²Œ ëœë‹¤. ì´ë•Œ ë¸Œë¼ìš°ì €ì˜ ì£¼ì†Œì°½ì€ ìƒˆ URLë¡œ ë°”ë€Œê²Œ ëœë‹¤..

* ì„œë¸”ë¦¿ì´ë‚˜ JSPëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ê¸° ìœ„í•´ HttpServletResponse í´ë˜ìŠ¤ì˜ sendRedirect() ë©”ì†Œë“œë¥¼ ì‚¬ìš©

  ```java
  response.sendRedirect("redirect02.jsp");
  ```

* **í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ì„ ë‘ ë²ˆ** ë³´ë‚´ê²Œ ëœë‹¤. -> ìš”ì²­ì´ ë“¤ì–´ê°ˆ ë•Œ í•­ìƒ ìš”ì²­ ê°ì²´ì™€ ì‘ë‹µ ê°ì²´ê°€ ìƒê¸°ëŠ”ë° í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ì„ ë‘ ë²ˆ ë³´ë‚¼ ë•Œ ê°ê° ìƒì„±ë˜ëŠ” ìš”ì²­, ì‘ë‹µ ê°ì²´ëŠ” ë‹¤ë¥¸ ê°ì²´ë“¤ì´ë‹¤.

  ![](https://cphinf.pstatic.net/mooc/20180127_5/1517046342330PRbSX_PNG/2_4_1_redirect__.PNG)

### 2) forward

1. ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ Servlet1ì—ê²Œ ìš”ì²­ì„ ë³´ëƒ„

2. Servlet1ì€ ìš”ì²­ì„ ì²˜ë¦¬í•œ í›„, ê·¸ **ê²°ê³¼ë¥¼ HttpServletRequest**ì— ì €ì¥

3. Servlet1ì€ ê²°ê³¼ê°€ ì €ì¥ëœ HttpServletRequestì™€ ì‘ë‹µì„ ìœ„í•œ HttpServletResponseë¥¼ **ê°™ì€ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì•ˆ**ì— ìˆëŠ” Servlet2ì—ê²Œ ì „ì†¡(**forward**)

4. Servlet2ëŠ” Servlet1ìœ¼ë¡œ ë¶€í„° ë°›ì€ HttpServletRequestì™€ HttpServletResponseë¥¼ ì´ìš©í•˜ì—¬ ìš”ì²­ì„ ì²˜ë¦¬í•œ í›„ ì›¹ ë¸Œë¼ìš°ì €ì—ê²Œ ê²°ê³¼ë¥¼ ì „ì†¡

   ```java
   	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
               
               int diceValue = (int)(Math.random() * 6) + 1; 
               request.setAttribute("dice", diceValue); //diceValueëŠ” Object íƒ€ì…
               
               RequestDispatcher requestDispatehcer = request.getRequestDispatcher("/next"); //ì´ë™í•  ì„œë¸”ë¦¿ ì£¼ì†Œë¥¼ ì ëŠ”ë‹¤. / í•„ìš”
               requestDispatehcer.forward(request, response);
       }
   ```

   ```java
   	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
           response.setContentType("text/html");
           PrintWriter out = response.getWriter();
           out.println("<html>");
           out.println("<head><title>form</title></head>");
           out.println("<body>");
   
           int dice = (Integer)request.getAttribute("dice"); //Objectíƒ€ì…ì´ê¸° ë•Œë¬¸ì— (Integer)ë¡œ í˜•ë³€í™˜
           out.println("dice : " + dice);
           for(int i = 0; i < dice; i++) {
               out.print("<br>hello");
           }
           out.println("</body>");
           out.println("</html>");
       }
   ```

* ìš”ì²­ì´ **í•˜ë‚˜** -> í´ë¼ì´ì–¸íŠ¸ê°€ ì²˜ìŒ ìš”ì²­í–ˆì„ ë•Œ ë§Œë“¤ì–´ì¡Œë˜ **ìš”ì²­, ì‘ë‹µ ê°ì²´ ê·¸ëŒ€ë¡œ ìœ ì§€**, **URL ë³€í™” ì—†ìŒ**

  

### 3) servlet & jsp ì—°ë™

* Servletì€ **í”„ë¡œê·¸ë¨ ë¡œì§ ìˆ˜í–‰**ì— ìœ ë¦¬, IDE ë“±ì—ì„œ ì§€ì›ì„ ì¢€ ë” ì˜í•´ì¤Œ

* JSPëŠ” **ê²°ê³¼ë¥¼ ì¶œë ¥**í•˜ê¸°ì— Servletë³´ë‹¤ ìœ ë¦¬, í•„ìš”í•œ htmlë¬¸ì„ ê·¸ëƒ¥ ì…ë ¥í•˜ë©´ ë¨.

  ğŸ‘‰ í”„ë¡œê·¸ë¨ ë¡œì§ ìˆ˜í–‰ì€ Servletì—ì„œ, ê²°ê³¼ ì¶œë ¥ì€ JSPì—ì„œ í•˜ëŠ” ê²ƒì´ ìœ ë¦¬í•˜ë‹¤.

* Servletê³¼ JSPì˜ ì¥ë‹¨ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ Servletì—ì„œ í”„ë¡œê·¸ë¨ ë¡œì§ì´ ìˆ˜í–‰ë˜ê³ , ê·¸ ê²°ê³¼ë¥¼ JSPì—ê²Œ í¬ì›Œë”©í•˜ëŠ” ë°©ë²• ì‚¬ìš© -> ì´ë¥¼ *Servletê³¼ JSPì—°ë™*ì´ë¼ê³  í•œë‹¤.

* jsp ì—ì„œëŠ” ë˜ë„ë¡ ìë°” ì½”ë“œë¥¼ ì¤„ì´ëŠ” ê²Œ ì¢‹ìŒ - EL í‘œê¸°ë²•..

  ```java
      protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
          int v1 = (int)(Math.random() * 100) + 1;
          int v2 = (int)(Math.random() * 100) + 1;
          int result = v1 + v2;
          
          request.setAttribute("v1", v1);
          request.setAttribute("v2", v2);
          request.setAttribute("result", result);
          
          RequestDispatcher requestDispatcher = request.getRequestDispatcher("/result.jsp");
          requestDispatcher.forward(request, response);
      }
  ```

  ```jsp
  ELí‘œê¸°ë²•ìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.<br>
  ${v1} + ${v2} = ${result} <br><br>
  
  ìŠ¤í´ë¦½í‹€ë¦¿ê³¼ í‘œí˜„ì‹ì„ ì´ìš©í•´ ì¶œë ¥í•©ë‹ˆë‹¤.<br>
  <%
      int v1 = (int)request.getAttribute("v1");
      int v2 = (int)request.getAttribute("v2");
      int result = (int)request.getAttribute("result");
  %>
  
  <%=v1%> + <%=v2 %> = <%=result %>
  ```

* URL mapping: https://help.perforce.com/hydraexpress/3.5.0/html/rwsfservletug/4-3.html